<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="tilepage.css">
    <title>Dashboard</title>
    <!-- Boxicons CDN Link -->
    <link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <!-- <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet"> -->
     <script src= "https://kit.fontawesome.com/ece23478c9.js"></script>
     <link rel="icon" href="images/Vector.png" type="image/svg+xml">
     <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300&display=swap" rel="stylesheet">     
   </head>
<body>
  <div class="sidebar">
    <div class="logo_content">
      <div class="logo">
        <img src ="images/logo__1_-removebg-preview.png" class="drive logo" alt="">
      </div>
      <i class='bx bx-menu' id="btn" ></i>
    </div>
    <ul class="nav_list">
     
      <li>
        <a href="tilepage.html">
          <i class='bx bx-home' ></i>
          <span class="links_name">My Files</span>
        </a>
        <span class="tooltip">My Files</span>
      </li>
      <li>
        <a href="#">
          <i class='bx bx-lock-alt' ></i>
          <span class="links_name">Encrypted</span>
        </a>
        <span class="tooltip">Encrypted</span>
      </li>
      <li>
        <a href="#">
          <i class='bx bx-history' ></i>
          <span class="links_name">Recent</span>
        </a>
        <span class="tooltip">Recent</span>
      </li>
      <li>
        <a href="#">
          <i class='bx bx-heart' ></i>
          <span class="links_name">Favourites</span>
        </a>
        <span class="tooltip">Favourites</span>
      </li>
      <li>
        <a href="#">
          <i class='bx bx-share' ></i>
          <span class="links_name">Shared with me</span>
        </a>
        <span class="tooltip">Shared with me</span>
      </li>
     
     
      <li>
        <a href="accountpage.html">
          <i class='bx bx-cog' ></i>
          <span class="links_name">Settings</span>
        </a>
        <span class="tooltip">Settings</span>
      </li>
    </ul>
    <div class="profile_content">
        <div class="profile">
            <centre>
                <img src="images/Illustration 1.png" class="upgrade image" alt="" width="100" height="100">
            </centre>
          </div>
        </div>
        </div>

<div class="main-content" >
    <div class="row">
    <div class="searchbar"> 
        <div class="searchbtn">
            <i class="fas fa-search"></i>
        </div>
        <input type="text" class="input_search" placeholder="Search">
    </div>
    <div class="filedropdown">
        <div class="filebtn">
        <button id="filebtn" class="filebtns" ><img src="images/user.png" alt=""> User</button>
    </div>
        <ul class="active" id="filemenu">
             <li id="account"  class="trn-bg divider"><a href="accountpage.html"><i class="fas fa-user-cog"></i><span class="setting">Account Settings</span></a></li>
            <li id="account" class="trn-bg divider"><i class="fas fa-sign-out-alt"></i><span class="setting" id="logout" onclick="openpopup1()">  Logout</span></li>
        </ul>
    </div>
</div>

<div class="row">
    <!-- <div class="tiles"> -->
        <h2 class="tiles">My Drive</h2>
    
     <form action="/files/upload" method="POST" id="filesupload">   
    <div class="file-input">
        <input type="file" id="add-file" class="add-file">
        <label for="add-file" id="addfilebtn" >Add New Files</label>
      </div>
      <!-- <div id="preview"></div> -->
    </form>
</div>
<hr class="cont">
<div id="preview"></div>
<!-- logout popup -->
<div class="bg-modal1">
  <div class="modal-content1">
      <h1>Logout</h1>
      <!-- <button class="closed" id="popupbtn1" onclick="closepopup1()">&times;</button> -->
      <hr style="margin-top: 13px;">
      <h5>Are you sure you want to logout?</h5>
          <!-- <button class="closed" id="popupbtn" onclick="closepopup()">&times;</button> -->
          <form method="DELETE" id="logout_account">
            <div class="popupbtn">
            <button type="submit" class="popup-del" id="log_acc">Logout</button>
            <button class="popup-cancel" id="popupbtn1" onclick="closepopup1()">Cancel</button>
          </div>
        </form>
  </div>
</div>
<!-- popup ends -->
</div>




<script
src="https://code.jquery.com/jquery-3.6.0.js"></script>
<script type="text/javascript">
// dropdown
$(document).ready(function(){
  $('.filebtns').click(function(){
      $('ul').toggleClass('active');
  })
})


//   sidebar opening n closing
   let btn = document.querySelector("#btn");
   let sidebar = document.querySelector(".sidebar");
  //  let searchBtn = document.querySelector(".bx-search");

   btn.onclick = function() {
     sidebar.classList.toggle("active");
     if(btn.classList.contains("bx-menu")){
       btn.classList.replace("bx-menu" , "bx-menu-alt-right");
     }else{
       btn.classList.replace("bx-menu-alt-right", "bx-menu");
     }
   }
  

  // logout
  var open= document.getElementById('logout');
var close= document.getElementById('popupbtn1');
function openpopup1(){
    document.querySelector('.bg-modal1').style.display="flex";
    document.querySelector("body").style.overflow="hidden";
    };
    open.onclick=openpopup1;

    function closepopup1(){
    document.querySelector('.bg-modal1').style.display="none";
    document.querySelector("body").style.overflow="visible";
    };
    close.onclick=closepopup1;
  </script>
</body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
 
// Logout
var logout_account = document.getElementById("logout_account");
logout_account.addEventListener("submit",function(e){
			e.preventDefault();
			fetch('https://gccstorage.herokuapp.com/logout', {
			  method: 'DELETE',
			  headers: {
				'Content-Type': 'application/json',
			  },
        body: JSON.stringify({}),
        credentials: "include"
			})
			.then(response => response.json())
			.then(data => {
			//   document.getElementById("warningmsg").innerHTML = data.message;
			//   $("#warningmsg").show();
			  console.log('Success:', data);	
        if (data.status == "ok") {
          window.location.href = "/index.html";
        }
			})
			.catch((error) => {
			  console.error('Error:', error);
			});
		});

    // Adding images
  function getImagePreview(event){
      let file = event.target.files[0];
      console.log(file.type);

      var image=URL.createObjectURL(file);
      var imagediv= document.getElementById('preview');
      var newimg= document.createElement('img');

      if (file.type =="application/pdf") {
        newimg.src="https://play-lh.googleusercontent.com/nufRXPpDI9XP8mPdAvOoJULuBIH_OK4YbZZVu8i_-eDPulZpgb-Xp-EmI8Z53AlXHpqX";
        newimg.style.border ="1px solid black";
        newimg.style.padding = "10px";
        newimg.style.margin = "10px";
      } else {
        newimg.src=image;
      }
      
    //   imagediv.innerHTML= '';
     
      newimg.width="300";
      newimg.style.border ="1px solid black";
      newimg.style.padding = "10px";
      newimg.style.margin = "10px";
      imagediv.appendChild(newimg);

      let formData = new FormData();
      formData.append("file", file, file.name);

      fetch('https://gccstorage.herokuapp.com/files/upload', {
			  method: 'POST',
			  headers: {
				'Content-Type': 'application/x-www-form-urlencoded',
			  },
			  body: formData,
        credentials: "include"      
			})
			.then(response => response.json())
			.then(data => {
        console.log(data)
			})
			.catch((error) => {
			  console.error('Error:', error);
			});
  }

  document.getElementById("add-file").addEventListener("change", getImagePreview);
</script>
</html>
